<!DOCTYPE html>
<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %}</title>
    <link rel="stylesheet" type="text/css" href={{ url_for("static", filename="css/base.css") }}>
    <!--Load React and React DOM-->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <!-- Load Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Load Axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js" integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ==" crossorigin="anonymous"></script>
    {% endblock %}
</head>
<body>
    <header>
        <div id="popup_wrap">
            <!--由Popup組件渲染-->
        </div>
        <div class="nav">
            <div class="logo">
                <a href="/"><h1>台北一日遊</h1></a>
            </div>
            <div class="menu">
                <ul>
                    <li><a href="#">預定行程</a></li>
                    <li><a id="showLoginForm" onclick="showLoginForm();">登入/註冊</a></li>
                </ul>
            </div>
        </div>
    </header>
    <script type="text/babel">
        function showLoginForm(){
            const popup=document.querySelector("#popup_wrap");
            popup.style.display="block";
        }
        class Popup extends React.Component{
            state={
                login:true
            }
            render(){
                let popup_height={height:'275px'};
                let form=<LoginForm/>;
                let hint=(
                    <div className="hint">
                        <p>還沒有帳戶？ <a onClick={this.changeFormType}>點此註冊</a></p>
                    </div>
                )
                if(!this.state.login){
                    popup_height={height:'332px'};
                    form=<SignupForm/>;
                    hint=(
                        <div className="hint">
                            <p>已經有帳戶了？ <a onClick={this.changeFormType}>點此登入</a></p>
                        </div>
                    )
                }
                return(
                    <div id="popup" style={popup_height}>
                        <div className="close_btn" onClick={this.closeLoginForm}>×</div>
                        {form}
                        {hint}
                    </div>
                )
            }
            closeLoginForm=()=>{
                const popup=document.querySelector("#popup_wrap");
                popup.style.display="none";
            }
            changeFormType=()=>{
                const login=this.state.login;
                this.setState({login:!login});
            }
        }
        class LoginForm extends React.Component{
            state={
                email:"",
                password:""
            }
            render(){
                return(
                    <div id="loginForm">
                        <form method="post" onSubmit={this.handleSubmit}>
                            <h3>登入會員帳號</h3>
                            <input type="email" name="email" id="email" placeholder="輸入電子信箱"
                                value={this.state.email} onChange={this.handleChange("email")}/>
                            <input type="password" name="password" id="password" placeholder="輸入密碼"
                                value={this.state.password} onChange={this.handleChange("password")}/>
                            <br />
                            <input type="submit" value="登入帳戶" />
                        </form>
                    </div>
                )
            }
            handleSubmit=(eObj)=>{
                eObj.preventDefault();
                const {email, password}=this.state;
                if(email==="" || password===""){
                    return
                }
                const data={email, password};
                console.log(data);
            }
            handleChange=(dataType)=>{
                return(eObj)=>{
                    this.setState({[dataType]:eObj.target.value});
                }
            }
        }
        class SignupForm extends React.Component{
            state={
                username:"",
                email:"",
                password:""
            }
            render(){
                return(
                    <div id="signupForm">
                        <form method="post"  onSubmit={this.handleSubmit}>
                            <h3>註冊會員帳號</h3>
                            <input type="text" name="username" id="username" placeholder="輸入姓名"
                                value={this.state.username} onChange={this.handleChange("username")}/>
                            <input type="email" name="email" id="email" placeholder="輸入電子信箱"
                                value={this.state.email} onChange={this.handleChange("email")}/>
                            <input type="password" name="password" id="password" placeholder="輸入密碼"
                                value={this.state.password} onChange={this.handleChange("password")}/>
                            <br />
                            <input type="submit" value="註冊新帳戶" />
                        </form>
                    </div>
                )
            }
            handleSubmit=(eObj)=>{
                eObj.preventDefault();
                const {username, email, password}=this.state;
                if(username==="" || email==="" || password===""){
                    return
                }
                const data={username, email, password};
                console.log(data);
            }
            handleChange=(dataType)=>{
                return(eObj)=>{
                    this.setState({[dataType]:eObj.target.value});
                }
            }
        }
        addEventListener("load", ()=>{
            ReactDOM.render(<Popup/>, document.querySelector("#popup_wrap"))
        })
    </script>
    {% block content %}
    
    {% endblock %}
    <footer>
        COPYRIGHT © 2021 台北一日遊
    </footer>
</body>
</html>